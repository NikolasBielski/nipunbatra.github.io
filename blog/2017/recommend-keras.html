<html>
				<head>
				<meta charset="utf-8">
			    <meta http-equiv="X-UA-Compatible" content="IE=edge">
			    <meta name="viewport" content="width=device-width, initial-scale=1">
			    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
			    <meta name="description" content="">
			    <meta name="author" content="">
			    <title>Recommender Systems in Keras</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


			      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            displayMath: [ ["$$",'$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
</head>
			    <body>
<nav class="navbar navbar-default">
    <div class="container text-center">

        <div id="navbar" class="navbar-collapse">
            <ul class="nav navbar-nav">
                <li><a href="../../index.html">Home</a></li>
                <li><a href="../../publications.html">Publications</a></li>
                <li><a href="../index.html">Blog</a></li>
                <li><a href="http://www.cs.virginia.edu/~nb2cz/files/cv.pdf">CV</a></li>
            </ul>
        </div>
    </div>
</nav>
			    <div class="container" margin="5%">
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Recommender-Systems-in-Keras">Recommender Systems in Keras<a class="anchor-link" href="#Recommender-Systems-in-Keras">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I have written a <a href="../nnmf-tensorflow.html">few</a> <a href="../nmf-autograd.html">posts</a> <a href="../nmf-cvx.html">earlier</a> <a href="../nmf-out-matrix.html">about</a> <a href="../mf-autograd-adagrad.html">matrix</a> <a href="../contrained-nmf-cvx.html">factorisation</a> <a href="../nmf-nnls.html">using</a> various Python libraries. The main application I had in mind for matrix factorisation was <a href="https://en.wikipedia.org/wiki/Recommender_system">recommender systems</a>. In this post, I'll write about using <a href="https://keras.io">Keras</a> for creating recommender systems. <a href="https://github.com/maciejkula/triplet_recommendations_keras">Various</a> <a href="http://blog.richardweiss.org/2016/09/25/movie-embeddings.html">people</a> <a href="https://github.com/bradleypallen/keras-movielens-cf">have</a> <a href="https://github.com/hexiangnan/neural_collaborative_filtering">written</a> <a href="https://github.com/sonyisme/keras-recommendation">excellent</a> <a href="http://course.fast.ai/lessons/lesson4.html">similar</a> <a href="https://github.com/maciejkula/spotlight">posts</a> and code that I draw a lot of inspiration from, and give them their credit! I'm assuming that a reader has some experience with Keras, as this post is not intended to be an introduction to Keras.</p>
<p>Specifically, in this post, I'll talk about:</p>
<ol>
<li>Matrix Factorisation in Keras</li>
<li>Adding non-negativitiy constraints to solve non-negative matrix factorisation (NNMF)</li>
<li>Using neural networks for recommendations</li>
</ol>
<p>I'll be using the Movielens-100k dataset for illustration. There are 943 users and 1682 movies. In total there are a 100k ratings in the dataset. It should be noted that the max. total number of rating for the &lt;users, movies&gt; would be 943*1682, which means that we have about 7% of the total ratings! All rating are on a scale of 1-5.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Task"><strong>Task</strong><a class="anchor-link" href="#Task">&#182;</a></h3><p>Given this set of ratings, can we recommend the next set of movies to a user? This would translate to: for every user, estimating the ratings for all the movies that (s)he hasn't watched and maybe recommend the top-k movies by the esimtated ratings!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Peak-into-the-dataset">Peak into the dataset<a class="anchor-link" href="#Peak-into-the-dataset">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/Users/nipun/Downloads/ml-100k/u.data&quot;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="s2">&quot;user_id,item_id,rating,timestamp&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[3]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>item_id</th>
      <th>rating</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>196</td>
      <td>242</td>
      <td>3</td>
      <td>881250949</td>
    </tr>
    <tr>
      <th>1</th>
      <td>186</td>
      <td>302</td>
      <td>3</td>
      <td>891717742</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22</td>
      <td>377</td>
      <td>1</td>
      <td>878887116</td>
    </tr>
    <tr>
      <th>3</th>
      <td>244</td>
      <td>51</td>
      <td>2</td>
      <td>880606923</td>
    </tr>
    <tr>
      <th>4</th>
      <td>166</td>
      <td>346</td>
      <td>1</td>
      <td>886397596</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So, each record (row) shows the rating for a user, item (movie) pair. It should be noted that I use  item and movie interchangeably in this post.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">user_id</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">item_id</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[4]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(943, 1682)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We assign a unique number between (0, #users) to each user and do the same for movies.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">user_id</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">user_id</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">values</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">item_id</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">item_id</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">values</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[6]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>item_id</th>
      <th>rating</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>195</td>
      <td>241</td>
      <td>3</td>
      <td>881250949</td>
    </tr>
    <tr>
      <th>1</th>
      <td>185</td>
      <td>301</td>
      <td>3</td>
      <td>891717742</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21</td>
      <td>376</td>
      <td>1</td>
      <td>878887116</td>
    </tr>
    <tr>
      <th>3</th>
      <td>243</td>
      <td>50</td>
      <td>2</td>
      <td>880606923</td>
    </tr>
    <tr>
      <th>4</th>
      <td>165</td>
      <td>345</td>
      <td>1</td>
      <td>886397596</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Train-test-split">Train test split<a class="anchor-link" href="#Train-test-split">&#182;</a></h3><p>We'll now split our dataset of 100k ratings into train (containing 80k ratings) and test (containing 20k ratings). Given the train set, we'd like to accurately estimate the ratings in the test set.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[8]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>item_id</th>
      <th>rating</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>84827</th>
      <td>855</td>
      <td>293</td>
      <td>4</td>
      <td>891489502</td>
    </tr>
    <tr>
      <th>27414</th>
      <td>427</td>
      <td>876</td>
      <td>5</td>
      <td>885943685</td>
    </tr>
    <tr>
      <th>23561</th>
      <td>494</td>
      <td>70</td>
      <td>5</td>
      <td>888634111</td>
    </tr>
    <tr>
      <th>41772</th>
      <td>61</td>
      <td>722</td>
      <td>2</td>
      <td>879375738</td>
    </tr>
    <tr>
      <th>74607</th>
      <td>882</td>
      <td>702</td>
      <td>3</td>
      <td>891693139</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[9]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>item_id</th>
      <th>rating</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>78376</th>
      <td>621</td>
      <td>28</td>
      <td>4</td>
      <td>882592735</td>
    </tr>
    <tr>
      <th>11506</th>
      <td>129</td>
      <td>741</td>
      <td>5</td>
      <td>876251053</td>
    </tr>
    <tr>
      <th>77568</th>
      <td>628</td>
      <td>287</td>
      <td>4</td>
      <td>880116722</td>
    </tr>
    <tr>
      <th>49588</th>
      <td>295</td>
      <td>1006</td>
      <td>4</td>
      <td>884196921</td>
    </tr>
    <tr>
      <th>19957</th>
      <td>285</td>
      <td>166</td>
      <td>5</td>
      <td>877533419</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Matrix-factorisation">Matrix factorisation<a class="anchor-link" href="#Matrix-factorisation">&#182;</a></h3><p>One popular recommender systems approach is called Matrix Factorisation. It works on the principle that we can learn a low-dimensional representation (embedding) of user and movie. For example, for each movie, we can have how much action it has, how long it is, and so on. For each user, we can encode how much they like action, or how much they like long movies, etc. Thus, we can combine the user and the movie embeddings to estimate the ratings on unseen movies. This approach can also be viewed as: given a matrix (A [M X N]) containing users and movies, we want to estimate low dimensional matrices (W [M X k] and H [M X k]), such that: $A \approx W.H^T$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Matrix-factorisation-in-Keras">Matrix factorisation in Keras<a class="anchor-link" href="#Matrix-factorisation-in-Keras">&#182;</a></h3><p>We'll now write some code to solve the recommendation problem by matrix factorisation in Keras. We're trying to learn two low-dimensional embeddings of users and items.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">keras</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">SVG</span>
<span class="kn">from</span> <span class="nn">keras.utils.vis_utils</span> <span class="k">import</span> <span class="n">model_to_dot</span>
<span class="n">n_users</span><span class="p">,</span> <span class="n">n_movies</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">user_id</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">item_id</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">n_latent_factors</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>Using TensorFlow backend.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The key thing is to learn an embedding for movies and users, and then combine them using the dot product! For estimating the rating, for each user, movie pair of interest, we'd take the dot product of the respective user and item embedding. As an example, if we have 2 dimensions in our user and item embedding, which say correspond to [how much user likes action, how much user likes long movies], and the item embedding is [how much action is in the movie, how long is the movie]. Then, we can predict for a user <code>u</code>, and movie <code>m</code> as how much <code>u</code> likes action $\times$ how much action is there in <code>m</code> $+$ how much <code>u</code> likes long movies $\times$ how long is <code>m</code>.</p>
<p>Our model would optimise the emebedding such that we minimise the mean squared error on the ratings from the train set.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">movie_input</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Item&#39;</span><span class="p">)</span>
<span class="n">movie_embedding</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">n_movies</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_latent_factors</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Movie-Embedding&#39;</span><span class="p">)(</span><span class="n">movie_input</span><span class="p">)</span>
<span class="n">movie_vec</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;FlattenMovies&#39;</span><span class="p">)(</span><span class="n">movie_embedding</span><span class="p">)</span>

<span class="n">user_input</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;User&#39;</span><span class="p">)</span>
<span class="n">user_vec</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;FlattenUsers&#39;</span><span class="p">)(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">n_users</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_latent_factors</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;User-Embedding&#39;</span><span class="p">)(</span><span class="n">user_input</span><span class="p">))</span>

<span class="n">prod</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">movie_vec</span><span class="p">,</span> <span class="n">user_vec</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;dot&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;DotProduct&#39;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">([</span><span class="n">user_input</span><span class="p">,</span> <span class="n">movie_input</span><span class="p">],</span> <span class="n">prod</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="s1">&#39;mean_squared_error&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here's a visualisation of our model for a better understanding.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SVG</span><span class="p">(</span><span class="n">model_to_dot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span>  <span class="n">show_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_layer_names</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rankdir</span><span class="o">=</span><span class="s1">&#39;HB&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">prog</span><span class="o">=</span><span class="s1">&#39;dot&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;svg&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[12]:</div>



<div class="output_svg output_subarea output_execute_result">
<svg height="296pt" viewBox="0.00 0.00 681.82 296.00" width="682pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g class="graph" id="graph0" transform="scale(1 1) rotate(0) translate(4 292)">
<title>G</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<polygon fill="white" points="-4,4 -4,-292 677.815,-292 677.815,4 -4,4" stroke="none"/>
<!-- 4716334832 -->
<g class="node" id="node1"><title>4716334832</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<polygon fill="none" points="48.2275,-243.5 48.2275,-287.5 284.783,-287.5 284.783,-243.5 48.2275,-243.5" stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="103.847" y="-261.3">Item: InputLayer</text>
<polyline fill="none" points="159.466,-243.5 159.466,-287.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="187.3" y="-272.3">input:</text>
<polyline fill="none" points="159.466,-265.5 215.135,-265.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="187.3" y="-250.3">output:</text>
<polyline fill="none" points="215.135,-243.5 215.135,-287.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="249.959" y="-272.3">(None, 1)</text>
<polyline fill="none" points="215.135,-265.5 284.783,-265.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="249.959" y="-250.3">(None, 1)</text>
</g>
<!-- 4716334944 -->
<g class="node" id="node3"><title>4716334944</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<polygon fill="none" points="0,-162.5 0,-206.5 333.011,-206.5 333.011,-162.5 0,-162.5" stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="96.8467" y="-180.3">Movie-Embedding: Embedding</text>
<polyline fill="none" points="193.693,-162.5 193.693,-206.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="221.528" y="-191.3">input:</text>
<polyline fill="none" points="193.693,-184.5 249.362,-184.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="221.528" y="-169.3">output:</text>
<polyline fill="none" points="249.362,-162.5 249.362,-206.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="291.187" y="-191.3">(None, 1)</text>
<polyline fill="none" points="249.362,-184.5 333.011,-184.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="291.187" y="-169.3">(None, 1, 3)</text>
</g>
<!-- 4716334832&#45;&gt;4716334944 -->
<g class="edge" id="edge1"><title>4716334832-&gt;4716334944</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<path d="M166.505,-243.329C166.505,-235.183 166.505,-225.699 166.505,-216.797" fill="none" stroke="black"/>
<polygon fill="black" points="170.005,-216.729 166.505,-206.729 163.005,-216.729 170.005,-216.729" stroke="black"/>
</g>
<!-- 4716201800 -->
<g class="node" id="node2"><title>4716201800</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<polygon fill="none" points="393.838,-243.5 393.838,-287.5 631.173,-287.5 631.173,-243.5 393.838,-243.5" stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="449.847" y="-261.3">User: InputLayer</text>
<polyline fill="none" points="505.855,-243.5 505.855,-287.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="533.69" y="-272.3">input:</text>
<polyline fill="none" points="505.855,-265.5 561.524,-265.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="533.69" y="-250.3">output:</text>
<polyline fill="none" points="561.524,-243.5 561.524,-287.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="596.349" y="-272.3">(None, 1)</text>
<polyline fill="none" points="561.524,-265.5 631.173,-265.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="596.349" y="-250.3">(None, 1)</text>
</g>
<!-- 4716290512 -->
<g class="node" id="node4"><title>4716290512</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<polygon fill="none" points="351.195,-162.5 351.195,-206.5 673.815,-206.5 673.815,-162.5 351.195,-162.5" stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="442.847" y="-180.3">User-Embedding: Embedding</text>
<polyline fill="none" points="534.498,-162.5 534.498,-206.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="562.333" y="-191.3">input:</text>
<polyline fill="none" points="534.498,-184.5 590.167,-184.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="562.333" y="-169.3">output:</text>
<polyline fill="none" points="590.167,-162.5 590.167,-206.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="631.991" y="-191.3">(None, 1)</text>
<polyline fill="none" points="590.167,-184.5 673.815,-184.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="631.991" y="-169.3">(None, 1, 3)</text>
</g>
<!-- 4716201800&#45;&gt;4716290512 -->
<g class="edge" id="edge2"><title>4716201800-&gt;4716290512</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<path d="M512.505,-243.329C512.505,-235.183 512.505,-225.699 512.505,-216.797" fill="none" stroke="black"/>
<polygon fill="black" points="516.005,-216.729 512.505,-206.729 509.005,-216.729 516.005,-216.729" stroke="black"/>
</g>
<!-- 4653571096 -->
<g class="node" id="node5"><title>4653571096</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<polygon fill="none" points="50.269,-81.5 50.269,-125.5 332.742,-125.5 332.742,-81.5 50.269,-81.5" stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="121.847" y="-99.3">FlattenMovies: Flatten</text>
<polyline fill="none" points="193.424,-81.5 193.424,-125.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="221.259" y="-110.3">input:</text>
<polyline fill="none" points="193.424,-103.5 249.093,-103.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="221.259" y="-88.3">output:</text>
<polyline fill="none" points="249.093,-81.5 249.093,-125.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="290.917" y="-110.3">(None, 1, 3)</text>
<polyline fill="none" points="249.093,-103.5 332.742,-103.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="290.917" y="-88.3">(None, 3)</text>
</g>
<!-- 4716334944&#45;&gt;4653571096 -->
<g class="edge" id="edge3"><title>4716334944-&gt;4653571096</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<path d="M173.205,-162.329C175.811,-154.094 178.849,-144.493 181.693,-135.507" fill="none" stroke="black"/>
<polygon fill="black" points="185.107,-136.319 184.787,-125.729 178.433,-134.207 185.107,-136.319" stroke="black"/>
</g>
<!-- 4716290960 -->
<g class="node" id="node6"><title>4716290960</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<polygon fill="none" points="363.328,-81.5 363.328,-125.5 635.683,-125.5 635.683,-81.5 363.328,-81.5" stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="429.847" y="-99.3">FlattenUsers: Flatten</text>
<polyline fill="none" points="496.366,-81.5 496.366,-125.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="524.2" y="-110.3">input:</text>
<polyline fill="none" points="496.366,-103.5 552.035,-103.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="524.2" y="-88.3">output:</text>
<polyline fill="none" points="552.035,-81.5 552.035,-125.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="593.859" y="-110.3">(None, 1, 3)</text>
<polyline fill="none" points="552.035,-103.5 635.683,-103.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="593.859" y="-88.3">(None, 3)</text>
</g>
<!-- 4716290512&#45;&gt;4716290960 -->
<g class="edge" id="edge4"><title>4716290512-&gt;4716290960</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<path d="M509.022,-162.329C507.681,-154.183 506.12,-144.699 504.656,-135.797" fill="none" stroke="black"/>
<polygon fill="black" points="508.076,-135.028 502.999,-125.729 501.169,-136.165 508.076,-135.028" stroke="black"/>
</g>
<!-- 4716290736 -->
<g class="node" id="node7"><title>4716290736</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<polygon fill="none" points="185.744,-0.5 185.744,-44.5 505.267,-44.5 505.267,-0.5 185.744,-0.5" stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="247.86" y="-18.3">DotProduct: Merge</text>
<polyline fill="none" points="309.977,-0.5 309.977,-44.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="337.812" y="-29.3">input:</text>
<polyline fill="none" points="309.977,-22.5 365.646,-22.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="337.812" y="-7.3">output:</text>
<polyline fill="none" points="365.646,-0.5 365.646,-44.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="435.457" y="-29.3">[(None, 3), (None, 3)]</text>
<polyline fill="none" points="365.646,-22.5 505.267,-22.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="434.97" y="-7.3">(None, 1)</text>
</g>
<!-- 4653571096&#45;&gt;4716290736 -->
<g class="edge" id="edge5"><title>4653571096-&gt;4716290736</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<path d="M232.775,-81.3294C252.013,-71.4605 275.075,-59.63 295.313,-49.2479" fill="none" stroke="black"/>
<polygon fill="black" points="297.089,-52.2704 304.39,-44.5919 293.894,-46.0421 297.089,-52.2704" stroke="black"/>
</g>
<!-- 4716290960&#45;&gt;4716290736 -->
<g class="edge" id="edge6"><title>4716290960-&gt;4716290736</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<path d="M458.236,-81.3294C438.998,-71.4605 415.936,-59.63 395.697,-49.2479" fill="none" stroke="black"/>
<polygon fill="black" points="397.116,-46.0421 386.621,-44.5919 393.921,-52.2704 397.116,-46.0421" stroke="black"/>
</g>
</g>
</svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that in the <code>Merge</code> layer, we take the dot product of the user and the item embeddings to obtain the rating.</p>
<p>We can also summarise our model as follows:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Item (InputLayer)               (None, 1)            0                                            
__________________________________________________________________________________________________
User (InputLayer)               (None, 1)            0                                            
__________________________________________________________________________________________________
Movie-Embedding (Embedding)     (None, 1, 3)         5049        Item[0][0]                       
__________________________________________________________________________________________________
User-Embedding (Embedding)      (None, 1, 3)         2832        User[0][0]                       
__________________________________________________________________________________________________
FlattenMovies (Flatten)         (None, 3)            0           Movie-Embedding[0][0]            
__________________________________________________________________________________________________
FlattenUsers (Flatten)          (None, 3)            0           User-Embedding[0][0]             
__________________________________________________________________________________________________
DotProduct (Merge)              (None, 1)            0           FlattenMovies[0][0]              
                                                                 FlattenUsers[0][0]               
==================================================================================================
Total params: 7,881
Trainable params: 7,881
Non-trainable params: 0
__________________________________________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So, we have 7881 parameters to learn! Let's train our model now!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">train</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">train</span><span class="o">.</span><span class="n">item_id</span><span class="p">],</span> <span class="n">train</span><span class="o">.</span><span class="n">rating</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Train-error-v/s-epoch-number">Train error v/s epoch number<a class="anchor-link" href="#Train-error-v/s-epoch-number">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before we test how well our model does in the test setting, we can visualise the train loss with epoch number.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">logy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Epoch&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Train Error&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[19]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.text.Text at 0x1a26fb66a0&gt;</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Prediction-error">Prediction error<a class="anchor-link" href="#Prediction-error">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's now see how our model does! I'll do a small post-processing step to round off our prediction to the nearest integer. This is usually not done, and thus just a whimsical step, since the training ratings are all integers! There are better ways to encode this intger requirement (one-hot encoding!), but we won't discuss them in this post.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">test</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">test</span><span class="o">.</span><span class="n">item_id</span><span class="p">]),</span><span class="mi">0</span><span class="p">)</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">rating</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">mean_absolute_error</span>
<span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_hat</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[22]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.68754999999999999</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Not bad! We're able to get a $MAE$ of 0.69! I'm sure with a bit of parameter/hyper-parameter optimisation, we may be able to improve the results. However, I won't talk about these optimisations in this post.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Extracting-the-learnt-embeddings">Extracting the learnt embeddings<a class="anchor-link" href="#Extracting-the-learnt-embeddings">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can extract the learnt movie and item embeddings as follows:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">movie_embedding_learnt</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_layer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Movie-Embedding&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">movie_embedding_learnt</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[24]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1683.000000</td>
      <td>1683.000000</td>
      <td>1683.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.912885</td>
      <td>0.853251</td>
      <td>-0.989291</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.561965</td>
      <td>0.452911</td>
      <td>0.407488</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.273091</td>
      <td>-1.075208</td>
      <td>-2.364467</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.499577</td>
      <td>0.532220</td>
      <td>-1.269455</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.922570</td>
      <td>0.808850</td>
      <td>-1.001768</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.349954</td>
      <td>1.160062</td>
      <td>-0.725322</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.021444</td>
      <td>2.256882</td>
      <td>0.540868</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">user_embedding_learnt</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_layer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;User-Embedding&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">user_embedding_learnt</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[25]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>944.000000</td>
      <td>944.000000</td>
      <td>944.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.118651</td>
      <td>1.186549</td>
      <td>-1.098431</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.537899</td>
      <td>0.419475</td>
      <td>0.544597</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.095650</td>
      <td>-0.327198</td>
      <td>-3.116111</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.780569</td>
      <td>0.956197</td>
      <td>-1.436500</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.152981</td>
      <td>1.193803</td>
      <td>-1.078698</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.496086</td>
      <td>1.450552</td>
      <td>-0.730524</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.798949</td>
      <td>2.641392</td>
      <td>0.479444</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that both the user and the item embeddings have negative elements. There are some applications which require that the learnt embeddings be non-negative. This approach is also called non-negative matrix factorisation, which we'll workout now.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Non-negative-Matrix-factorisation-(NNMF)-in-Keras">Non-negative Matrix factorisation (NNMF) in Keras<a class="anchor-link" href="#Non-negative-Matrix-factorisation-(NNMF)-in-Keras">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The code for NNMF remains exactly the same as the code for matrix factorisation. The only change is that we add <code>non-negativity</code> constraints on the learnt embeddings. This is done as follows:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">keras.constraints</span> <span class="k">import</span> <span class="n">non_neg</span>
<span class="n">movie_input</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Item&#39;</span><span class="p">)</span>
<span class="n">movie_embedding</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">n_movies</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_latent_factors</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;NonNegMovie-Embedding&#39;</span><span class="p">,</span> <span class="n">embeddings_constraint</span><span class="o">=</span><span class="n">non_neg</span><span class="p">())(</span><span class="n">movie_input</span><span class="p">)</span>
<span class="n">movie_vec</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;FlattenMovies&#39;</span><span class="p">)(</span><span class="n">movie_embedding</span><span class="p">)</span>

<span class="n">user_input</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;User&#39;</span><span class="p">)</span>
<span class="n">user_vec</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;FlattenUsers&#39;</span><span class="p">)(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">n_users</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_latent_factors</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;NonNegUser-Embedding&#39;</span><span class="p">,</span><span class="n">embeddings_constraint</span><span class="o">=</span><span class="n">non_neg</span><span class="p">())(</span><span class="n">user_input</span><span class="p">))</span>

<span class="n">prod</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">movie_vec</span><span class="p">,</span> <span class="n">user_vec</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;dot&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;DotProduct&#39;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">([</span><span class="n">user_input</span><span class="p">,</span> <span class="n">movie_input</span><span class="p">],</span> <span class="n">prod</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="s1">&#39;mean_squared_error&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We now verify if we are indeed able to learn non-negative embeddings. I'll not compare the performance of NNMF on the test set, in the interest of space.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">history_nonneg</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">train</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">train</span><span class="o">.</span><span class="n">item_id</span><span class="p">],</span> <span class="n">train</span><span class="o">.</span><span class="n">rating</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">movie_embedding_learnt</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_layer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;NonNegMovie-Embedding&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">movie_embedding_learnt</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[29]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1683.000000</td>
      <td>1683.000000</td>
      <td>1683.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.011195</td>
      <td>0.863916</td>
      <td>0.868112</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.436693</td>
      <td>0.511042</td>
      <td>0.438383</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-0.000000</td>
      <td>-0.000000</td>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.734240</td>
      <td>0.461567</td>
      <td>0.528087</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.014148</td>
      <td>0.860229</td>
      <td>0.862545</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.279842</td>
      <td>1.264946</td>
      <td>1.178649</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.807231</td>
      <td>2.372965</td>
      <td>2.838957</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Looks good!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Neural-networks-for-recommendation">Neural networks for recommendation<a class="anchor-link" href="#Neural-networks-for-recommendation">&#182;</a></h3><p>We'll now create a simple neural network for recommendation, or for estimating rating! This model is very similar to the earlier matrix factorisation models, but differs in the following ways:</p>
<ol>
<li>Instead of taking a dot product of the user and the item embedding, we concatenate them and use them as features for our neural network. Thus, we are not constrained to the dot product way of combining the embeddings, and can learn complex non-linear relationships.</li>
<li>Due to #1, we can now have a different dimension of user and item embeddings. This can be useful if one dimension is larger than the other.</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_latent_factors_user</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n_latent_factors_movie</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">movie_input</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Item&#39;</span><span class="p">)</span>
<span class="n">movie_embedding</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">n_movies</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_latent_factors_movie</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Movie-Embedding&#39;</span><span class="p">)(</span><span class="n">movie_input</span><span class="p">)</span>
<span class="n">movie_vec</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;FlattenMovies&#39;</span><span class="p">)(</span><span class="n">movie_embedding</span><span class="p">)</span>

<span class="n">user_input</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;User&#39;</span><span class="p">)</span>
<span class="n">user_vec</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;FlattenUsers&#39;</span><span class="p">)(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">n_users</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_latent_factors_user</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;User-Embedding&#39;</span><span class="p">)(</span><span class="n">user_input</span><span class="p">))</span>


<span class="n">concat</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">movie_vec</span><span class="p">,</span> <span class="n">user_vec</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;concat&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Concat&#39;</span><span class="p">)</span>
<span class="n">dense</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;FullyConnected&#39;</span><span class="p">)(</span><span class="n">concat</span><span class="p">)</span>
<span class="n">dropout</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Dropout&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Activation&#39;</span><span class="p">)(</span><span class="n">dense</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">([</span><span class="n">user_input</span><span class="p">,</span> <span class="n">movie_input</span><span class="p">],</span> <span class="n">result</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="s1">&#39;mean_squared_error&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's now see how our model looks like:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SVG</span><span class="p">(</span><span class="n">model_to_dot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span>  <span class="n">show_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_layer_names</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rankdir</span><span class="o">=</span><span class="s1">&#39;HB&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">prog</span><span class="o">=</span><span class="s1">&#39;dot&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;svg&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[39]:</div>



<div class="output_svg output_subarea output_execute_result">
<svg height="458pt" viewBox="0.00 0.00 681.82 458.00" width="682pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g class="graph" id="graph0" transform="scale(1 1) rotate(0) translate(4 454)">
<title>G</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<polygon fill="white" points="-4,4 -4,-454 677.815,-454 677.815,4 -4,4" stroke="none"/>
<!-- 112451573296 -->
<g class="node" id="node1"><title>112451573296</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<polygon fill="none" points="48.2275,-405.5 48.2275,-449.5 284.783,-449.5 284.783,-405.5 48.2275,-405.5" stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="103.847" y="-423.3">Item: InputLayer</text>
<polyline fill="none" points="159.466,-405.5 159.466,-449.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="187.3" y="-434.3">input:</text>
<polyline fill="none" points="159.466,-427.5 215.135,-427.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="187.3" y="-412.3">output:</text>
<polyline fill="none" points="215.135,-405.5 215.135,-449.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="249.959" y="-434.3">(None, 1)</text>
<polyline fill="none" points="215.135,-427.5 284.783,-427.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="249.959" y="-412.3">(None, 1)</text>
</g>
<!-- 112451573408 -->
<g class="node" id="node3"><title>112451573408</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<polygon fill="none" points="0,-324.5 0,-368.5 333.011,-368.5 333.011,-324.5 0,-324.5" stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="96.8467" y="-342.3">Movie-Embedding: Embedding</text>
<polyline fill="none" points="193.693,-324.5 193.693,-368.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="221.528" y="-353.3">input:</text>
<polyline fill="none" points="193.693,-346.5 249.362,-346.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="221.528" y="-331.3">output:</text>
<polyline fill="none" points="249.362,-324.5 249.362,-368.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="291.187" y="-353.3">(None, 1)</text>
<polyline fill="none" points="249.362,-346.5 333.011,-346.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="291.187" y="-331.3">(None, 1, 5)</text>
</g>
<!-- 112451573296&#45;&gt;112451573408 -->
<g class="edge" id="edge1"><title>112451573296-&gt;112451573408</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<path d="M166.505,-405.329C166.505,-397.183 166.505,-387.699 166.505,-378.797" fill="none" stroke="black"/>
<polygon fill="black" points="170.005,-378.729 166.505,-368.729 163.005,-378.729 170.005,-378.729" stroke="black"/>
</g>
<!-- 112451585360 -->
<g class="node" id="node2"><title>112451585360</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<polygon fill="none" points="393.838,-405.5 393.838,-449.5 631.173,-449.5 631.173,-405.5 393.838,-405.5" stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="449.847" y="-423.3">User: InputLayer</text>
<polyline fill="none" points="505.855,-405.5 505.855,-449.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="533.69" y="-434.3">input:</text>
<polyline fill="none" points="505.855,-427.5 561.524,-427.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="533.69" y="-412.3">output:</text>
<polyline fill="none" points="561.524,-405.5 561.524,-449.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="596.349" y="-434.3">(None, 1)</text>
<polyline fill="none" points="561.524,-427.5 631.173,-427.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="596.349" y="-412.3">(None, 1)</text>
</g>
<!-- 112451573912 -->
<g class="node" id="node4"><title>112451573912</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<polygon fill="none" points="351.195,-324.5 351.195,-368.5 673.815,-368.5 673.815,-324.5 351.195,-324.5" stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="442.847" y="-342.3">User-Embedding: Embedding</text>
<polyline fill="none" points="534.498,-324.5 534.498,-368.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="562.333" y="-353.3">input:</text>
<polyline fill="none" points="534.498,-346.5 590.167,-346.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="562.333" y="-331.3">output:</text>
<polyline fill="none" points="590.167,-324.5 590.167,-368.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="631.991" y="-353.3">(None, 1)</text>
<polyline fill="none" points="590.167,-346.5 673.815,-346.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="631.991" y="-331.3">(None, 1, 3)</text>
</g>
<!-- 112451585360&#45;&gt;112451573912 -->
<g class="edge" id="edge2"><title>112451585360-&gt;112451573912</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<path d="M512.505,-405.329C512.505,-397.183 512.505,-387.699 512.505,-378.797" fill="none" stroke="black"/>
<polygon fill="black" points="516.005,-378.729 512.505,-368.729 509.005,-378.729 516.005,-378.729" stroke="black"/>
</g>
<!-- 112451585472 -->
<g class="node" id="node5"><title>112451585472</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<polygon fill="none" points="50.269,-243.5 50.269,-287.5 332.742,-287.5 332.742,-243.5 50.269,-243.5" stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="121.847" y="-261.3">FlattenMovies: Flatten</text>
<polyline fill="none" points="193.424,-243.5 193.424,-287.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="221.259" y="-272.3">input:</text>
<polyline fill="none" points="193.424,-265.5 249.093,-265.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="221.259" y="-250.3">output:</text>
<polyline fill="none" points="249.093,-243.5 249.093,-287.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="290.917" y="-272.3">(None, 1, 5)</text>
<polyline fill="none" points="249.093,-265.5 332.742,-265.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="290.917" y="-250.3">(None, 5)</text>
</g>
<!-- 112451573408&#45;&gt;112451585472 -->
<g class="edge" id="edge3"><title>112451573408-&gt;112451585472</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<path d="M173.205,-324.329C175.811,-316.094 178.849,-306.493 181.693,-297.507" fill="none" stroke="black"/>
<polygon fill="black" points="185.107,-298.319 184.787,-287.729 178.433,-296.207 185.107,-298.319" stroke="black"/>
</g>
<!-- 112450303312 -->
<g class="node" id="node6"><title>112450303312</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<polygon fill="none" points="363.328,-243.5 363.328,-287.5 635.683,-287.5 635.683,-243.5 363.328,-243.5" stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="429.847" y="-261.3">FlattenUsers: Flatten</text>
<polyline fill="none" points="496.366,-243.5 496.366,-287.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="524.2" y="-272.3">input:</text>
<polyline fill="none" points="496.366,-265.5 552.035,-265.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="524.2" y="-250.3">output:</text>
<polyline fill="none" points="552.035,-243.5 552.035,-287.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="593.859" y="-272.3">(None, 1, 3)</text>
<polyline fill="none" points="552.035,-265.5 635.683,-265.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="593.859" y="-250.3">(None, 3)</text>
</g>
<!-- 112451573912&#45;&gt;112450303312 -->
<g class="edge" id="edge4"><title>112451573912-&gt;112450303312</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<path d="M509.022,-324.329C507.681,-316.183 506.12,-306.699 504.656,-297.797" fill="none" stroke="black"/>
<polygon fill="black" points="508.076,-297.028 502.999,-287.729 501.169,-298.165 508.076,-297.028" stroke="black"/>
</g>
<!-- 112453191888 -->
<g class="node" id="node7"><title>112453191888</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<polygon fill="none" points="198.192,-162.5 198.192,-206.5 492.819,-206.5 492.819,-162.5 198.192,-162.5" stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="247.86" y="-180.3">Concat: Merge</text>
<polyline fill="none" points="297.529,-162.5 297.529,-206.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="325.363" y="-191.3">input:</text>
<polyline fill="none" points="297.529,-184.5 353.198,-184.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="325.363" y="-169.3">output:</text>
<polyline fill="none" points="353.198,-162.5 353.198,-206.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="423.008" y="-191.3">[(None, 5), (None, 3)]</text>
<polyline fill="none" points="353.198,-184.5 492.819,-184.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="422.522" y="-169.3">(None, 8)</text>
</g>
<!-- 112451585472&#45;&gt;112453191888 -->
<g class="edge" id="edge5"><title>112451585472-&gt;112453191888</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<path d="M232.775,-243.329C252.013,-233.46 275.075,-221.63 295.313,-211.248" fill="none" stroke="black"/>
<polygon fill="black" points="297.089,-214.27 304.39,-206.592 293.894,-208.042 297.089,-214.27" stroke="black"/>
</g>
<!-- 112450303312&#45;&gt;112453191888 -->
<g class="edge" id="edge6"><title>112450303312-&gt;112453191888</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<path d="M458.236,-243.329C438.998,-233.46 415.936,-221.63 395.697,-211.248" fill="none" stroke="black"/>
<polygon fill="black" points="397.116,-208.042 386.621,-206.592 393.921,-214.27 397.116,-208.042" stroke="black"/>
</g>
<!-- 112449824192 -->
<g class="node" id="node8"><title>112449824192</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<polygon fill="none" points="201.941,-81.5 201.941,-125.5 489.069,-125.5 489.069,-81.5 201.941,-81.5" stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="275.847" y="-99.3">FullyConnected: Dense</text>
<polyline fill="none" points="349.752,-81.5 349.752,-125.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="377.586" y="-110.3">input:</text>
<polyline fill="none" points="349.752,-103.5 405.421,-103.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="377.586" y="-88.3">output:</text>
<polyline fill="none" points="405.421,-81.5 405.421,-125.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="447.245" y="-110.3">(None, 8)</text>
<polyline fill="none" points="405.421,-103.5 489.069,-103.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="447.245" y="-88.3">(None, 100)</text>
</g>
<!-- 112453191888&#45;&gt;112449824192 -->
<g class="edge" id="edge7"><title>112453191888-&gt;112449824192</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<path d="M345.505,-162.329C345.505,-154.183 345.505,-144.699 345.505,-135.797" fill="none" stroke="black"/>
<polygon fill="black" points="349.005,-135.729 345.505,-125.729 342.005,-135.729 349.005,-135.729" stroke="black"/>
</g>
<!-- 112453146160 -->
<g class="node" id="node9"><title>112453146160</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<polygon fill="none" points="217.11,-0.5 217.11,-44.5 473.9,-44.5 473.9,-0.5 217.11,-0.5" stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="275.847" y="-18.3">Activation: Dense</text>
<polyline fill="none" points="334.583,-0.5 334.583,-44.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="362.417" y="-29.3">input:</text>
<polyline fill="none" points="334.583,-22.5 390.252,-22.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="362.417" y="-7.3">output:</text>
<polyline fill="none" points="390.252,-0.5 390.252,-44.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="432.076" y="-29.3">(None, 100)</text>
<polyline fill="none" points="390.252,-22.5 473.9,-22.5 " stroke="black"/>
<text font-family="Times,serif" font-size="14.00" text-anchor="middle" x="432.076" y="-7.3">(None, 1)</text>
</g>
<!-- 112449824192&#45;&gt;112453146160 -->
<g class="edge" id="edge8"><title>112449824192-&gt;112453146160</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


<path d="M345.505,-81.3294C345.505,-73.1826 345.505,-63.6991 345.505,-54.7971" fill="none" stroke="black"/>
<polygon fill="black" points="349.005,-54.729 345.505,-44.729 342.005,-54.729 349.005,-54.729" stroke="black"/>
</g>
</g>
</svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It should be noted that we use a different number of embeddings for user (3) and items (5)! These combine to form a vector of length (5+3 = 8), which is then fed into the neural network. We also add a dropout layer to prevent overfitting!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Item (InputLayer)               (None, 1)            0                                            
__________________________________________________________________________________________________
User (InputLayer)               (None, 1)            0                                            
__________________________________________________________________________________________________
Movie-Embedding (Embedding)     (None, 1, 5)         8415        Item[0][0]                       
__________________________________________________________________________________________________
User-Embedding (Embedding)      (None, 1, 3)         2832        User[0][0]                       
__________________________________________________________________________________________________
FlattenMovies (Flatten)         (None, 5)            0           Movie-Embedding[0][0]            
__________________________________________________________________________________________________
FlattenUsers (Flatten)          (None, 3)            0           User-Embedding[0][0]             
__________________________________________________________________________________________________
Concat (Merge)                  (None, 8)            0           FlattenMovies[0][0]              
                                                                 FlattenUsers[0][0]               
__________________________________________________________________________________________________
FullyConnected (Dense)          (None, 100)          900         Concat[0][0]                     
__________________________________________________________________________________________________
Activation (Dense)              (None, 1)            101         FullyConnected[0][0]             
==================================================================================================
Total params: 12,248
Trainable params: 12,248
Non-trainable params: 0
__________________________________________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that the number of parameters is more than what we had in the Matrix Factorisation case. Let's see how this model works. I'll run it for more epochs given that we have more parameters.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">train</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">train</span><span class="o">.</span><span class="n">item_id</span><span class="p">],</span> <span class="n">train</span><span class="o">.</span><span class="n">rating</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Prediction-performance-of-Neural-Network-based-recommender-system">Prediction performance of Neural Network based recommender system<a class="anchor-link" href="#Prediction-performance-of-Neural-Network-based-recommender-system">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[43]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_hat_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">test</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">test</span><span class="o">.</span><span class="n">item_id</span><span class="p">]),</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_hat_2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[43]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.70304999999999995</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pretty similar to the result we got using matrix factorisation. Maybe, we need to tweak around a lot more with the neural network to get better results?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Thanks for reading. This post has been a good learning experience for me. Hope you enjoyed too!</p>

</div>
</div>
</div>
 

</div><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-96903131-1', 'auto');
  ga('send', 'pageview');

</script>
<div class="container">
<div id="share" class="navbar-static-bottom"></div>


    <script>
        $("#share").jsSocials({
            shares: ["email", "twitter", "facebook", "googleplus", "linkedin", "pinterest", "stumbleupon", "whatsapp"]
        });
    </script>

<div id="disqus_thread"></div>

<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://nipunbatra-1.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                                
    

<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


</body></html>